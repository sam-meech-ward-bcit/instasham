(this.webpackJsonpinstasam=this.webpackJsonpinstasam||[]).push([[0],{110:function(e,t,a){e.exports=a(140)},115:function(e,t,a){},140:function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"login",(function(){return Se})),a.d(n,"logout",(function(){return Ne})),a.d(n,"signUp",(function(){return Ie})),a.d(n,"savePost",(function(){return We})),a.d(n,"saveComment",(function(){return De})),a.d(n,"likePost",(function(){return Ae})),a.d(n,"getPosts",(function(){return Fe})),a.d(n,"getComments",(function(){return Re})),a.d(n,"me",(function(){return Te}));var r=a(0),o=a.n(r),c=a(9),i=a.n(c),s=(a(115),a(12)),u=a(69),l=a(13),m=a(42),p=a(68),d=a(18),f=a(11),b=a.n(f),h=a(24),g=a(175),v=a(19),E=a(16),O=a(177),j=a(178),w=a(179),k=a(63),x=a(192),y=a(99),C=a(193),S=a(92),N=a.n(S),I=a(93),P=a.n(I),W=a(91),D=a.n(W),A=Object(g.a)((function(e){return{grow:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:Object(v.a)({display:"none"},e.breakpoints.up("sm"),{display:"block"}),search:Object(v.a)({position:"relative",borderRadius:e.shape.borderRadius,backgroundColor:Object(E.b)(e.palette.common.white,.15),"&:hover":{backgroundColor:Object(E.b)(e.palette.common.white,.25)},marginRight:e.spacing(2),marginLeft:0,width:"100%"},e.breakpoints.up("sm"),{marginLeft:e.spacing(3),width:"auto"}),searchIcon:{padding:e.spacing(0,2),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"},inputRoot:{color:"inherit"},inputInput:Object(v.a)({padding:e.spacing(1,1,1,0),paddingLeft:"calc(1em + ".concat(e.spacing(4),"px)"),transition:e.transitions.create("width"),width:"100%"},e.breakpoints.up("md"),{width:"20ch"}),sectionDesktop:Object(v.a)({display:"none"},e.breakpoints.up("md"),{display:"flex"}),sectionMobile:Object(v.a)({display:"flex"},e.breakpoints.up("md"),{display:"none"})}}));function F(e){var t=A(),a=o.a.useState(null),n=Object(s.a)(a,2),r=n[0],c=n[1],i=Boolean(r),u=function(){c(null)};return o.a.createElement("div",{className:t.grow},o.a.createElement(O.a,{position:"static"},o.a.createElement(j.a,null,o.a.createElement(w.a,{"aria-label":"add a new post",onClick:e.newPost,color:"inherit"},o.a.createElement(D.a,null)),o.a.createElement(k.a,{className:t.title,variant:"h6",noWrap:!0},"InstaSam"),o.a.createElement("div",{className:t.search},o.a.createElement("div",{className:t.searchIcon},o.a.createElement(N.a,null)),o.a.createElement(x.a,{placeholder:"Search\u2026",classes:{root:t.inputRoot,input:t.inputInput},inputProps:{"aria-label":"search"}})),o.a.createElement("div",{className:t.grow}),o.a.createElement(w.a,{edge:"end","aria-label":"account of current user","aria-controls":"menu-appbar","aria-haspopup":"true",onClick:function(e){c(e.currentTarget)},color:"inherit"},o.a.createElement(P.a,null)),o.a.createElement(y.a,{id:"menu-appbar",anchorEl:r,anchorOrigin:{vertical:"top",horizontal:"right"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:i,onClose:u},o.a.createElement(C.a,{onClick:u},"Profile"),o.a.createElement(C.a,{onClick:function(){u(),e.signOut()}},"Sign Out")))))}var R=a(180),T=a(190),L=a(181),B=a(182),z=a(194),M=a(183),U=a(184),J=a(189),V=a(185),_=a(77),G=a(4),Y=a(62),$=a(94),q=a.n($),H=a(95),K=a.n(H),Q=a(96),X=a.n(Q),Z=Object(g.a)((function(e){return{root:{width:600},media:{height:0,paddingTop:"56.25%"},expand:{transform:"rotate(0deg)",marginLeft:"auto",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},avatar:{backgroundColor:Y.a[500]},textField:{flexGrow:1},description:{marginBottom:10},mainCardContent:{paddingTop:0}}}));function ee(e){var t=Z(e),a=Object(r.useState)(""),n=Object(s.a)(a,2),c=n[0],i=n[1],u=e.post,l=(e.user,e.me),m=(_.a,o.a.useState(!1)),p=Object(s.a)(m,2),f=p[0],b=p[1],h=u.media.map((function(e,a){return o.a.createElement(R.a,{key:a,className:t.media,image:e.url})})),g=u.comments.map((function(e){return o.a.createElement(T.a,{display:"flex",key:e.id},o.a.createElement(k.a,{variant:"subtitle2",component:"h6"},e.user.username,": \xa0"),o.a.createElement(k.a,{variant:"body2",color:"textSecondary",component:"p"},e.message))}));return o.a.createElement(L.a,{className:"".concat(t.root," ").concat(e.className)},o.a.createElement(B.a,{avatar:o.a.createElement(z.a,{"aria-label":"user",alt:u.user.username,src:u.user.profile_photo,className:t.avatar}),title:u.user.username,subheader:""}),h,o.a.createElement(M.a,{disableSpacing:!0},o.a.createElement(w.a,{"aria-label":"like",onClick:function(){e.like(u)}},l.liked?o.a.createElement(q.a,null):o.a.createElement(K.a,null)),o.a.createElement(w.a,{className:Object(G.a)(t.expand,Object(v.a)({},t.expandOpen,f)),onClick:function(){var t=!f;b(t),e.setExpanded(Object(d.a)({},u,{flag:t}))},"aria-expanded":f,"aria-label":"show more"},o.a.createElement(X.a,null))),o.a.createElement(U.a,{className:t.mainCardContent},o.a.createElement(k.a,{className:t.description,variant:"body2",component:"p"},"Liked by ",u.total_likes," people"),o.a.createElement(k.a,{className:t.description,variant:"body2",component:"p"},u.total_comments||0," comments"),o.a.createElement(k.a,{className:t.description,variant:"body2",color:"textSecondary",component:"p"},u.description),g),o.a.createElement("hr",null),o.a.createElement("form",{className:t.root,noValidate:!0,autoComplete:"off",onSubmit:function(t){t.preventDefault(),e.submitComment({message:c,id:u.id})}},o.a.createElement(T.a,{display:"flex"},o.a.createElement(J.a,{value:c,onChange:function(e){return i(e.target.value)},className:t.textField,id:"standard-basic",label:"Add a comment..."}),o.a.createElement(V.a,{type:"submit"},"Post"))))}var te=a(97),ae=Object(g.a)((function(e){return{root:{width:600},input:{display:"none"}}}));function ne(e){var t=ae(),a=Object(r.useState)({}),n=Object(s.a)(a,2),c=n[0],i=n[1],u=Object(r.useState)(""),l=Object(s.a)(u,2),m=l[0],p=l[1];return o.a.createElement(L.a,{className:t.root},o.a.createElement(te.a,{images:c,setImages:i,allowCrop:!1}),o.a.createElement("form",{onSubmit:function(t){t.preventDefault(),e.onSubmit({images:c,description:m})}},o.a.createElement(J.a,{value:m,onChange:function(e){return p(e.target.value)},label:"Description"}),o.a.createElement(V.a,{type:"submit"},"Post")))}var re=Object(g.a)((function(e){return{posts:{display:"flex",flexDirection:"column",alignItems:"center"},post:{margin:"10px 0"}}}));function oe(e){var t=Object(r.useState)([]),a=Object(s.a)(t,2),n=a[0],c=a[1],i=Object(r.useState)(!1),u=Object(s.a)(i,2),l=u[0],m=u[1],f=re(e);Object(r.useEffect)((function(){Object(h.a)(b.a.mark((function t(){var a;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getPosts();case 2:a=t.sent,console.log(a),c(a.posts);case 5:case"end":return t.stop()}}),t)})))()}),[]);var g=function(){var t=Object(h.a)(b.a.mark((function t(a){var n,r,o,i;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=a.message,r=a.id,t.next=3,e.saveComment({message:n,postId:r});case 3:o=t.sent,i=o.comment,c((function(e){return e.map((function(e){return e.id!=r?e:Object(d.a)({},e,{comments:[i].concat(Object(p.a)(e.comments))})}))}));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),v=function(){var t=Object(h.a)(b.a.mark((function t(a){var n,r,o,i,s;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(i in n=a.images,r=a.description,o=[],n)o.push(n[i]);return t.next=5,e.savePost({images:o,description:r});case 5:s=t.sent,console.log(s),c((function(e){return[s.post].concat(Object(p.a)(e))})),m(!1);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),E=function(){var t=Object(h.a)(b.a.mark((function t(a){var n,r,o;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=a.id,t.next=3,e.likePost({postId:n});case 3:r=t.sent,o=r.post,c((function(e){return e.map((function(e){return e.id!=n?e:o}))}));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),O=function(){var t=Object(h.a)(b.a.mark((function t(a){var n,r,o;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=a.id,!a.flag){t.next=9;break}return t.next=4,e.getComments({postId:n});case 4:r=t.sent,o=r.comments,c((function(e){return e.map((function(e){return e.id!=n?e:Object(d.a)({},e,{comments:o})}))})),t.next=10;break;case 9:c((function(e){return e.map((function(e){return e.id!=n?e:Object(d.a)({},e,{comments:e.comments.slice(0,2)})}))}));case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),j=n.map((function(t){return o.a.createElement(ee,{key:t.id,className:f.post,submitComment:g,like:E,comment:console.log,user:e.user,post:t,setExpanded:O,me:{liked:!0}})}));return o.a.createElement("div",null,o.a.createElement(F,{signOut:e.logout,newPost:function(){m((function(e){return!e}))}}),o.a.createElement("div",{className:f.posts},l?o.a.createElement(ne,{onSubmit:v}):j))}var ce=a(65),ie=Object(g.a)((function(e){return{button:{fontSize:"1.2em",borderRadius:"8px","&:hover":{}},buttonIcon:{height:"100%",margin:0}}}));function se(e){var t=ie(e),a=e.icon?ce[e.icon]:null;return o.a.createElement(w.a,Object.assign({},e,{size:"medium",className:"".concat(t.button," ").concat(e.className),onClick:e.onClick,color:"inherit","aria-label":"menu"}),a&&o.a.createElement(a,{className:t.buttonIcon}),e.children)}var ue=Object(g.a)((function(e){return{root:{},button:{margin:"20px 0",width:"100%"},input:{display:"none"}}}));function le(e){var t=ue(e),a=Object(r.useState)({username:"",email:"",password:"",image:null}),n=Object(s.a)(a,2),c=n[0],i=n[1],u=Object(r.createRef)();function l(e){return function(t){var a=Object(d.a)({},c);a[e]=t.target.value,i(a)}}return o.a.createElement("form",{onSubmit:function(t){t.preventDefault(),e.onSubmit(Object(d.a)({},c,{image:u.current.files[0]}))},className:t.root,noValidate:!0,autoComplete:"off"},o.a.createElement(J.a,{value:c.username,onChange:l("username"),id:"username-input",fullWidth:!0,label:"Username"}),o.a.createElement(J.a,{value:c.email,onChange:l("email"),id:"email-input",fullWidth:!0,label:"Email"}),o.a.createElement(J.a,{type:"password",value:c.password,onChange:l("password"),id:"password-input",fullWidth:!0,label:"Password"}),o.a.createElement("input",{accept:"image/*",className:t.input,id:"contained-button-file",multiple:!0,type:"file",ref:u}),o.a.createElement("label",{htmlFor:"contained-button-file"},o.a.createElement(se,{className:t.button,variant:"contained",color:"primary",component:"span"},"Profile Image")),o.a.createElement(se,{className:t.button,type:"submit"},"Sign Me Up!"))}var me=Object(g.a)((function(e){return{container:Object(v.a)({maxWidth:"600px",margin:"auto"},e.breakpoints.down("sm"),{maxWidth:"80%"})}}));function pe(e){var t=Object(r.useState)(null),a=Object(s.a)(t,2),n=a[0],c=a[1],i=me(e);function u(){return(u=Object(h.a)(b.a.mark((function t(a){var n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:c(null),t.t0=b.a.keys(a);case 2:if((t.t1=t.t0()).done){t.next=9;break}if(n=t.t1.value,a[n]){t.next=7;break}return c("You must enter a valid ".concat(n)),t.abrupt("return");case 7:t.next=2;break;case 9:return t.prev=9,t.next=12,e.signup(a);case 12:t.next=17;break;case 14:t.prev=14,t.t2=t.catch(9),c(t.t2.message);case 17:case"end":return t.stop()}}),t,null,[[9,14]])})))).apply(this,arguments)}return o.a.createElement("div",{className:i.container},o.a.createElement(le,{onSubmit:function(e){return u.apply(this,arguments)}}),o.a.createElement(k.a,null,"Already have an account? ",o.a.createElement(m.b,{to:"/login"},"Login")),n&&o.a.createElement(k.a,null,n))}var de=Object(g.a)((function(e){return{root:{},button:{margin:"20px 0",width:"100%"}}}));function fe(e){var t=de(e),a=Object(r.useState)({username:"",password:"",email:""}),n=Object(s.a)(a,2),c=n[0],i=n[1];function u(e){return function(t){var a=Object(d.a)({},c);a[e]=t.target.value,i(a)}}return o.a.createElement("form",{onSubmit:function(t){t.preventDefault(),e.onSubmit(c)},className:t.root,noValidate:!0,autoComplete:"off"},o.a.createElement(J.a,{value:c.email,onChange:u("email"),id:"email-input",fullWidth:!0,label:"Email"}),o.a.createElement(J.a,{type:"password",value:c.password,onChange:u("password"),id:"password-input",fullWidth:!0,label:"Password"}),o.a.createElement(se,{className:t.button,type:"submit"},"Login"))}var be=Object(g.a)((function(e){return{container:Object(v.a)({maxWidth:"600px",margin:"auto"},e.breakpoints.down("sm"),{maxWidth:"80%"})}}));function he(e){var t=Object(r.useState)(null),a=Object(s.a)(t,2),n=a[0],c=a[1],i=be();function u(){return(u=Object(h.a)(b.a.mark((function t(a){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c(null),t.prev=1,t.next=4,e.signin(a);case 4:t.next=9;break;case 6:t.prev=6,t.t0=t.catch(1),c(t.t0.message);case 9:case"end":return t.stop()}}),t,null,[[1,6]])})))).apply(this,arguments)}return o.a.createElement("div",{className:i.container},o.a.createElement(fe,{onSubmit:function(e){return u.apply(this,arguments)}}),o.a.createElement(k.a,null,"Don't have an account? ",o.a.createElement(m.b,{to:"/signup"},"Sign up")),n&&o.a.createElement(k.a,null,n))}var ge=a(53),ve=a.n(ge),Ee=a(191),Oe=a(98),je=a.n(Oe);function we(){return localStorage.getItem("token")}function ke(e){localStorage.setItem("token",e)}function xe(){var e,t=we();if(!t)return null;try{e=je()(t)}catch(a){console.log(a)}return e}function ye(){var e=we();return e?{Authorization:"Bearer ".concat(e)}:{}}function Ce(e){var t=e.method,a=e.path,n=e.params;console.log(ye());var r=Object(d.a)({},ye(),{"Access-Control-Allow-Origin":"*",Accept:"application/json","Content-Type":"application/json"});return console.log("headers",r),"get"==t?ve.a[t](a,{headers:r}):ve.a[t](a,n,{headers:r})}var Se=function(e){var t=e.email,a=e.password;return console.log(t,a),Ce({method:"post",path:"/api/users/login",params:{user:{email:t,password:a}}}).then((function(e){var t=e.data.accessToken;console.log(t),ke(t);var a=xe();return a||null}))},Ne=function(){return localStorage.removeItem("token"),Ce({method:"post",path:"/api/users/logout"}).then((function(e){return e.data}))},Ie=function(e){var t=e.email,a=e.password,n=e.username,r=e.image;console.log(t,a,r);var o=new FormData;return o.append("avatar",r),o.append("user",JSON.stringify({email:t,password:a,username:n,fullName:"Full name"})),ve.a.post("/api/users",o,{headers:Object(d.a)({"Content-Type":"multipart/form-data"},ye())}).then((function(e){var t=e.data.accessToken;console.log(t),ke(t);var a=xe();return a||null}))},Pe=function(e,t){for(var a=e.split(","),n=a[0].match(/:(.*?);/)[1],r=atob(a[1]),o=r.length,c=new Uint8Array(o);o;)c[o-1]=r.charCodeAt(o-1),o-=1;return new File([c],t||Object(Ee.a)(),{type:n})};function We(e){var t=e.images,a=e.description,n=new FormData;return t.map(Pe).forEach((function(e){return n.append("images",e)})),n.append("description",a),ve.a.post("/api/posts",n,{headers:Object(d.a)({"Content-Type":"multipart/form-data"},ye())}).then((function(e){return e.data}))}function De(e){var t=e.postId,a=e.message;return Ce({method:"post",path:"/api/posts/".concat(t,"/comments"),params:{message:a,postId:t}}).then((function(e){return e.data}))}function Ae(e){var t=e.postId;return Ce({method:"post",path:"/api/posts/".concat(t,"/likes"),params:{postId:t}}).then((function(e){return e.data}))}function Fe(){return Ce({method:"get",path:"/api/posts?limit=11"}).then((function(e){return e.data}))}function Re(e){var t=e.postId;return Ce({method:"get",path:"/api/posts/".concat(t,"/comments")}).then((function(e){return e.data}))}function Te(){return Le.apply(this,arguments)}function Le(){return(Le=Object(h.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=xe()){e.next=3;break}return e.abrupt("return",null);case 3:return e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Be=a(188),ze=a(100),Me=a(186),Ue=a(187);function Je(e){var t,a=(t=e.pallet,Object(ze.a)({backgroundColor:t.light?"white":"black"}));return o.a.createElement(o.a.Fragment,null,o.a.createElement(Me.a,{theme:a},o.a.createElement(Ue.a,null),e.children))}function Ve(e){var t=e.component,a=e.user,n=Object(u.a)(e,["component","user"]);return o.a.createElement(l.b,Object.assign({},n,{render:function(e){return a?o.a.createElement(t,Object.assign({},e,n)):o.a.createElement(l.a,{to:{pathname:"/login",state:{from:e.location}}})}}))}function _e(e){var t=e.component,a=e.user,n=Object(u.a)(e,["component","user"]);return o.a.createElement(l.b,Object.assign({},n,{render:function(e){return a?o.a.createElement(l.a,{to:"/"}):o.a.createElement(t,e)}}))}var Ge=function(){var e=Object(r.useState)(null),t=Object(s.a)(e,2),a=t[0],c=t[1],i=Object(r.useState)(null),u=Object(s.a)(i,2),p=u[0],d=u[1],f=function(e){e.then((function(e){return e?e.errors?(d(e.errors[0]),void c(null)):(d(null),void c(e.user)):(d(null),void c(null))})).catch((function(e){console.log(e),d("Invalid email or password"),c(null)}))};Object(r.useEffect)((function(){f(Te())}),[]);var b=function(e){f(Se(e))},h=function(e){f(Ie(e))},g=function(){c(null),Ne()},v=Object(Be.a)("(prefers-color-scheme: dark)");return o.a.createElement(Je,{pallet:v?"dark":"light"},p?o.a.createElement("h2",null,p,"..."):o.a.createElement(m.a,null,o.a.createElement(l.d,null,o.a.createElement(_e,{path:"/login",user:a,component:function(){return o.a.createElement(he,{signin:b})}}),o.a.createElement(_e,{path:"/signup",user:a,component:function(){return o.a.createElement(pe,{signup:h})}}),o.a.createElement(Ve,{path:"/",user:a,component:function(){return o.a.createElement(oe,Object.assign({},n,{logout:g,user:a}))}}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(Ge,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[110,1,2]]]);
//# sourceMappingURL=main.31358d8f.chunk.js.map